<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
  
    <title>여행 Listing Page</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css" />
    <link rel="stylesheet" href="assets/css/templatemo-plot-listing.css" />
    <link rel="stylesheet" href="assets/css/animated.css" />
    <link rel="stylesheet" href="assets/css/owl.css" />
  
  </head>
<script>
 //qvEOTIicBtTaAfcpq7GMlTRRJNizust39C9zt8aZGwJEBaYqrMkXwYdU72yADNtSx7g%2BoqNuyFNl2HV3fDxEzg%3D%3D
let numOfRows = 10;
let totalCount = 0;
let pageNo = 1; // 현재 페이지 번호를 저장 할 변수
let totalPage = 0;


let commonInfoAddr =  ``;
let zipCode =  ``;

function getParameter(paraName) {
  // 쿼리스트링에서 넘겨 받은 paramName 을 찾아 그 변수의 값을 retrun 한다.
  // 만약 쿼리스트링에 paramName 이 없다면 null 을 return 한다
  let url = location.href;
  let returnVal = null;

  if (url.indexOf("?") != -1) {
    // 쿼리스트링이 있을때
    let queryString = url.split("?")[1];
    let tmpAr = queryString.split("&");
    for (let item of tmpAr) {
      if (item.split("=")[0] == paraName) {
        returnVal = item.split("=")[1];
        break; // 해당 반복문 블럭을 빠져나감
      }
    }
  }
  return returnVal;
}

$(function () {
        let contentId = getParameter("contentid");
        if (contentId == null) {
          alert("해당 페이지는 존재하지 않습니다!");
          location.href = "travel_listing.html";
        } else {
        //   getTourData(contentId); //contentId 의 추가 정보
          getAdditionalImg(contentId); // contentId 의 추가 이미지 데이터를 ajax로 호출하기 위한 함수
          getAddDetail(contentId);
        }
      });



function getAddDetail(contentId) { // 관광지의 개요를 얻어오기 위한 함수
  let url = `http://apis.data.go.kr/B551011/KorService/detailCommon?MobileOS=ETC&MobileApp=AppTest&serviceKey=qvEOTIicBtTaAfcpq7GMlTRRJNizust39C9zt8aZGwJEBaYqrMkXwYdU72yADNtSx7g%2BoqNuyFNl2HV3fDxEzg%3D%3D&_type=json&contentId=${contentId}&contentTypeId=25&defaultYN=Y&firstImageYN=Y&areacodeYN=Y&catcodeYN=Y&addrinfoYN=Y&mapinfoYN=Y&overviewYN=Y`;

  $.ajax({
          url: url,
          type: "GET",
          dataType: "json",
          async:false,
          success: function (data) {
          console.log(data);
          makeDetailView(data);
          },
        })
        function makeDetailView(data) {
          let detailText = data.response.body.items.item[0].overview;
          let title = data.response.body.items.item[0].title;
          let output = ``;
          console.log(detailText);
        $("#text").html(detailText);
        $("#title").html(title);
         
        }
}


      function getAdditionalImg(contentId) { //관광지의 추가 이미지를 얻어오기 위한 함수 
        // let url = `https://apis.data.go.kr/B551011/KorService/detailImage?MobileOS=ETC&MobileApp=AppTest&serviceKey=qvEOTIicBtTaAfcpq7GMlTRRJNizust39C9zt8aZGwJEBaYqrMkXwYdU72yADNtSx7g%2BoqNuyFNl2HV3fDxEzg%3D%3D&_type=json&contentId=${contentId}&imageYN=Y&subImageYN=Y`;
        let url = `https://apis.data.go.kr/B551011/KorService/detailInfo?MobileOS=ETC&MobileApp=AppTest&serviceKey=qvEOTIicBtTaAfcpq7GMlTRRJNizust39C9zt8aZGwJEBaYqrMkXwYdU72yADNtSx7g%2BoqNuyFNl2HV3fDxEzg%3D%3D&_type=json&contentId=${contentId}&contentTypeId=25`;
        $.ajax({
          url: url,
          type: "GET",
          dataType: "json",
          async:false,
          success: function (data) {
            console.log(data);
            makeImgSlider(data);
          },
        })

        function makeImgSlider(data) {
          
          let img = data.response.body.items.item;
          if(data.response.body.items != ""){
          console.log(img);
          let output = ``;
          let outputImg = ``;

          $.each(img, function (i, e) {
            if (i == 0){
              output += `<button type="button" data-bs-target="#demo" data-bs-slide-to="${i}" class="active"></button>`;
              outputImg += `<div class="carousel-item active">
              <img src="${e.subdetailimg}" alt="${e.contentid}" class="d-block w-100"></div>`;
            } else {
              output += `<button type="button" data-bs-target="#demo" data-bs-slide-to="${i}"></button>`;
              outputImg += `<div class="carousel-item">
              <img src="${e.subdetailimg}" alt="${e.contentid}" class="d-block w-100"></div>`;
            }
          })

          $(".carousel-indicators").html(output);
          $(".carousel-inner").html(outputImg);
          }else {
            $("#demo").remove();
          }
      }
    }
     


</script>
<style>
body{
        font-family: 'NanumSquareNeo-Variable';
}
.col-lg-12 {
    flex: 0 0 auto;
    width: 70%;
}
.w-100{
    max-height: 600px;
    width: 700px;
}
.page-heading{
  padding: 100px 0px 100px 600px;
}

</style>
  <body>
    <!-- ***** Preloader Start ***** -->
    <div id="js-preloader" class="js-preloader">
      <div class="preloader-inner">
        <span class="dot"></span>
        <div class="dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
    <!-- ***** Preloader End ***** -->

    <!-- ***** Header Area Start ***** -->
    <header
      class="header-area header-sticky wow slideInDown"
      data-wow-duration="0.75s"
      data-wow-delay="0s"
    >
      <div class="container">
        <div class="row">
          <div class="col-12">
            <nav class="main-nav">
              <!-- ***** Logo Start ***** -->
              <a href="index.html" class="logo"> </a>
              <!-- ***** Logo End ***** -->
              <!-- ***** Menu Start ***** -->
              <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="category.html">Category</a></li>
                <li><a href="listing.html" >Listing</a></li>
                <li><a href="contact.html">Contact Us</a></li>
                <li>
                  <div class="main-white-button">
                    <a href="#"><i class="fa fa-plus"></i> Add Your Listing</a>
                  </div>
                </li>
              </ul>
              <a class="menu-trigger">
                <span>Menu</span>
              </a>
              <!-- ***** Menu End ***** -->
            </nav>
          </div>
        </div>
      </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <div class="page-heading">
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
            <div class="top-text header-text">
              
              <h2>관광 데이터 검색 상세</h2>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="listing-page">
      <div class="container">
<b><div id="title"></div></b>
<div id="moreImg"></div>

        <div class="row">
          <div class="col-lg-12">
            <div class="naccs">
              <div class="grid">
                <div class="row">

          

                  
                    
                      <!-- first category listing of items -->
                      
                     
                          <div class="col-lg-12">
                            <div class="owl-carousel owl-listing" id="tourInfo">
                              <!-- <div class="item">
                                <div class="row">
                                  
                                    <div class="listing-item" id="tourInfo" >

                                      <div class="left-image" >
                                        <a href="#"
                                          ><img
                                            src="assets/images/listing-01.jpg"
                                            alt=""
                                        /></a>
                                        <div class="hover-content">
                                          <div class="main-white-button">
                                            <a href="contact.html"
                                              ><i class="fa fa-eye"></i> Contact
                                              Now</a
                                            >
                                          </div>
                                        </div>
                                      </div>


                                      <div class="right-content align-self-center">
                                        <a href="#"><h4>
                                            Sunshine Paradise Apartment
                                          </h4></a>
                                        <h6>by: Real ESTATE Agent</h6>
                                        <span class="price"
                                          ><div class="icon">
                                            <img
                                              src="assets/images/listing-icon-01.png"
                                              alt=""
                                            />
                                          </div>
                                          $600 / month included tax</span
                                        >
                                        <span class="details"
                                          >Details: <em>860 sq ft</em></span
                                        >
                                        <span class="info"
                                          ><img
                                            src="assets/images/listing-icon-02.png"
                                            alt=""
                                          />
                                          2 Bedrooms<br /><img
                                            src="assets/images/listing-icon-03.png"
                                            alt=""
                                          />
                                          3 Bathrooms</span
                                        >
                                      </div>


                                    </div>
                                  
                                 
                                 
                                </div>
                              </div> -->
                              
                             
                          </div>
                       
                     

                      
                          <div class="container mt-5">
                            <div id="demo" class="carousel slide" data-bs-ride="carousel">
                              <div class="carousel-indicators">
                    
                              </div>
                    
                            <div class="carousel-inner">
                    
                            </div>
                    
                              <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon"></span>
                              </button>
                              <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
                                <span class="carousel-control-next-icon"></span>
                              </button>
                        
                        </div>
                     

                             
                          
                   <br/><h3>개요</h3><br/>
                   
                   <div id="text"></div>
                  </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div>
      <!-- <div class="d-grid">
        <button type="button" id="morePage" class="btn btn-primary btn-block">
          다음 페이지로
        </button>
      </div> -->
    </div>
    <footer>
      
          <div class="col-lg-12">
            <div class="sub-footer">
              <p>
                Copyright © 2021 Plot Listing Co., Ltd. All Rights Reserved.
                <br />
                Design:
                <a
                  rel="nofollow"
                  href="https://templatemo.com"
                  title="CSS Templates"
                  >TemplateMo</a
                >
              </p>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/animation.js"></script>
    <script src="assets/js/imagesloaded.js"></script>
    <script src="assets/js/custom.js"></script>
  </body>
</html>
